{"ast":null,"code":"var _jsxFileName = \"c:\\\\sophia\\\\windsurf\\\\sizible-dev\\\\frontend\\\\src\\\\pages\\\\admin\\\\ExcelUploadPage.js\",\n  _s = $RefreshSig$();\n/**\n * Excel Upload Page\n * \n * This page allows admin users to upload Excel files containing product data.\n * It handles file validation, upload, and displays processing status.\n */\n\nimport React, { useState, useEffect, useRef } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport styled from 'styled-components';\nimport SizibleNavigation from '../../components/common/SizibleNavigation';\nimport SizibleButton from '../../components/common/SizibleButton';\nimport SizibleCard from '../../components/common/SizibleCard';\n\n// Styled components\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst PageContainer = styled.div`\n  padding: ${props => props.theme.spacing.large};\n  max-width: 1200px;\n  margin: 0 auto;\n`;\n_c = PageContainer;\nconst PageHeader = styled.div`\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: ${props => props.theme.spacing.large};\n  \n  @media (max-width: 768px) {\n    flex-direction: column;\n    align-items: flex-start;\n    gap: ${props => props.theme.spacing.medium};\n  }\n`;\n_c2 = PageHeader;\nconst UploadArea = styled.div`\n  border: 2px dashed ${props => props.isDragging ? props.theme.colors.primary : '#ddd'};\n  border-radius: ${props => props.theme.borderRadius.medium};\n  padding: ${props => props.theme.spacing.xlarge};\n  text-align: center;\n  margin-bottom: ${props => props.theme.spacing.large};\n  transition: all 0.3s ease;\n  background-color: ${props => props.isDragging ? 'rgba(0, 123, 255, 0.05)' : 'transparent'};\n  cursor: pointer;\n`;\n_c3 = UploadArea;\nconst UploadIcon = styled.div`\n  font-size: 3rem;\n  margin-bottom: ${props => props.theme.spacing.medium};\n  color: ${props => props.theme.colors.primary};\n`;\n_c4 = UploadIcon;\nconst FileInput = styled.input`\n  display: none;\n`;\n_c5 = FileInput;\nconst ProgressContainer = styled.div`\n  margin: ${props => props.theme.spacing.large} 0;\n`;\n_c6 = ProgressContainer;\nconst ProgressBar = styled.div`\n  height: 10px;\n  background-color: #f0f0f0;\n  border-radius: 5px;\n  margin-top: ${props => props.theme.spacing.small};\n  overflow: hidden;\n`;\n_c7 = ProgressBar;\nconst ProgressFill = styled.div`\n  height: 100%;\n  width: ${props => props.progress}%;\n  background-color: ${props => props.theme.colors.primary};\n  transition: width 0.3s ease;\n`;\n_c8 = ProgressFill;\nconst StatusMessage = styled.div`\n  padding: ${props => props.theme.spacing.medium};\n  border-radius: ${props => props.theme.borderRadius.small};\n  margin: ${props => props.theme.spacing.medium} 0;\n  background-color: ${props => {\n  switch (props.type) {\n    case 'success':\n      return 'rgba(40, 167, 69, 0.1)';\n    case 'error':\n      return 'rgba(220, 53, 69, 0.1)';\n    case 'info':\n      return 'rgba(0, 123, 255, 0.1)';\n    default:\n      return 'transparent';\n  }\n}};\n  color: ${props => {\n  switch (props.type) {\n    case 'success':\n      return '#28a745';\n    case 'error':\n      return '#dc3545';\n    case 'info':\n      return '#007bff';\n    default:\n      return 'inherit';\n  }\n}};\n  border-left: 4px solid ${props => {\n  switch (props.type) {\n    case 'success':\n      return '#28a745';\n    case 'error':\n      return '#dc3545';\n    case 'info':\n      return '#007bff';\n    default:\n      return 'transparent';\n  }\n}};\n`;\n_c9 = StatusMessage;\nconst UploadHistoryCard = styled(SizibleCard)`\n  margin-top: ${props => props.theme.spacing.xlarge};\n`;\n_c10 = UploadHistoryCard;\nconst HistoryTable = styled.table`\n  width: 100%;\n  border-collapse: collapse;\n  \n  th, td {\n    padding: ${props => props.theme.spacing.small};\n    text-align: left;\n    border-bottom: 1px solid #eee;\n  }\n  \n  th {\n    font-weight: ${props => props.theme.typography.fontWeight.medium};\n  }\n`;\n_c11 = HistoryTable;\nconst StatusBadge = styled.span`\n  display: inline-block;\n  padding: 4px 8px;\n  border-radius: 12px;\n  font-size: 0.8rem;\n  background-color: ${props => {\n  switch (props.status) {\n    case 'success':\n      return 'rgba(40, 167, 69, 0.1)';\n    case 'failed':\n      return 'rgba(220, 53, 69, 0.1)';\n    case 'processing':\n      return 'rgba(255, 193, 7, 0.1)';\n    default:\n      return 'rgba(0, 123, 255, 0.1)';\n  }\n}};\n  color: ${props => {\n  switch (props.status) {\n    case 'success':\n      return '#28a745';\n    case 'failed':\n      return '#dc3545';\n    case 'processing':\n      return '#ffc107';\n    default:\n      return '#007bff';\n  }\n}};\n`;\n\n/**\n * Excel Upload Page Component\n * \n * @returns {JSX.Element} The Excel upload page component\n */\n_c12 = StatusBadge;\nconst ExcelUploadPage = () => {\n  _s();\n  const navigate = useNavigate();\n  const fileInputRef = useRef(null);\n  const [isDragging, setIsDragging] = useState(false);\n  const [selectedFile, setSelectedFile] = useState(null);\n  const [uploadProgress, setUploadProgress] = useState(0);\n  const [uploadStatus, setUploadStatus] = useState(null);\n  const [isUploading, setIsUploading] = useState(false);\n  const [uploadHistory, setUploadHistory] = useState([]);\n\n  // Check if admin is authenticated\n  useEffect(() => {\n    const isAuthenticated = localStorage.getItem('adminAuthenticated') === 'true';\n    if (!isAuthenticated) {\n      navigate('/admin/login');\n    }\n\n    // Fetch upload history from the backend\n    const fetchUploadHistory = async () => {\n      try {\n        const response = await fetch('http://localhost:5000/api/admin/upload-history');\n        if (response.ok) {\n          const data = await response.json();\n          if (data.history && Array.isArray(data.history)) {\n            // Transform the data to match our frontend format\n            const formattedHistory = data.history.map(item => ({\n              id: item.id,\n              filename: item.filename,\n              timestamp: new Date(item.created_at).toLocaleString(),\n              status: item.success_count > 0 ? 'success' : 'failed',\n              records: item.success_count || 0\n            }));\n            setUploadHistory(formattedHistory);\n          }\n        } else {\n          console.error('Failed to fetch upload history');\n          // Fallback to sample data if API fails\n          setUploadHistory([{\n            id: 1,\n            filename: 'products_march_2025.xlsx',\n            timestamp: '2025-03-15 14:32',\n            status: 'success',\n            records: 124\n          }, {\n            id: 2,\n            filename: 'products_feb_2025.xlsx',\n            timestamp: '2025-02-22 09:15',\n            status: 'success',\n            records: 98\n          }, {\n            id: 3,\n            filename: 'test_upload.xlsx',\n            timestamp: '2025-02-10 16:45',\n            status: 'failed',\n            records: 0\n          }]);\n        }\n      } catch (error) {\n        console.error('Error fetching upload history:', error);\n        // Fallback to sample data if API fails\n        setUploadHistory([{\n          id: 1,\n          filename: 'products_march_2025.xlsx',\n          timestamp: '2025-03-15 14:32',\n          status: 'success',\n          records: 124\n        }, {\n          id: 2,\n          filename: 'products_feb_2025.xlsx',\n          timestamp: '2025-02-22 09:15',\n          status: 'success',\n          records: 98\n        }, {\n          id: 3,\n          filename: 'test_upload.xlsx',\n          timestamp: '2025-02-10 16:45',\n          status: 'failed',\n          records: 0\n        }]);\n      }\n    };\n    fetchUploadHistory();\n  }, [navigate]);\n\n  // Handle drag events\n  const handleDragOver = e => {\n    e.preventDefault();\n    setIsDragging(true);\n  };\n  const handleDragLeave = () => {\n    setIsDragging(false);\n  };\n  const handleDrop = e => {\n    e.preventDefault();\n    setIsDragging(false);\n    const files = e.dataTransfer.files;\n    if (files.length > 0) {\n      handleFileSelect(files[0]);\n    }\n  };\n\n  // Handle file selection\n  const handleFileSelect = file => {\n    // Check if file is an Excel file\n    if (file && (file.type === 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' || file.type === 'application/vnd.ms-excel')) {\n      setSelectedFile(file);\n      setUploadStatus({\n        type: 'info',\n        message: `File \"${file.name}\" selected and ready for upload.`\n      });\n    } else {\n      setSelectedFile(null);\n      setUploadStatus({\n        type: 'error',\n        message: 'Please select a valid Excel file (.xlsx or .xls).'\n      });\n    }\n  };\n\n  // Handle file input change\n  const handleFileInputChange = e => {\n    if (e.target.files.length > 0) {\n      handleFileSelect(e.target.files[0]);\n    }\n  };\n\n  // Handle upload button click\n  const handleUploadClick = () => {\n    fileInputRef.current.click();\n  };\n\n  // Handle file upload\n  const handleUpload = async () => {\n    if (!selectedFile) {\n      setUploadStatus({\n        type: 'error',\n        message: 'Please select a file to upload.'\n      });\n      return;\n    }\n    setIsUploading(true);\n    setUploadProgress(0);\n    setUploadStatus({\n      type: 'info',\n      message: 'Uploading file...'\n    });\n    try {\n      const formData = new FormData();\n      formData.append('file', selectedFile);\n\n      // Optionally, add user/admin info if needed\n      // formData.append('userId', adminUserId);\n\n      const response = await fetch('http://localhost:5000/api/admin/upload-excel', {\n        method: 'POST',\n        body: formData\n      });\n      const result = await response.json();\n      if (response.ok) {\n        setUploadStatus({\n          type: 'success',\n          message: result.message || 'File uploaded and processed successfully.'\n        });\n        setSelectedFile(null);\n        // Optionally, fetch updated upload history from backend here\n        // For now, append to local history\n        const now = new Date();\n        const timestamp = `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}-${String(now.getDate()).padStart(2, '0')} ${String(now.getHours()).padStart(2, '0')}:${String(now.getMinutes()).padStart(2, '0')}`;\n        setUploadHistory(prevHistory => [{\n          id: prevHistory.length + 1,\n          filename: selectedFile.name,\n          timestamp,\n          status: 'success',\n          records: result.recordsUpdated || result.records || 0\n        }, ...prevHistory]);\n      } else {\n        setUploadStatus({\n          type: 'error',\n          message: result.error || 'Failed to upload or process file.'\n        });\n        setUploadHistory(prevHistory => [{\n          id: prevHistory.length + 1,\n          filename: selectedFile.name,\n          timestamp: new Date().toISOString().slice(0, 16).replace('T', ' '),\n          status: 'failed',\n          records: 0\n        }, ...prevHistory]);\n      }\n    } catch (err) {\n      setUploadStatus({\n        type: 'error',\n        message: 'An error occurred during upload.'\n      });\n    } finally {\n      setIsUploading(false);\n      setUploadProgress(100);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(SizibleNavigation, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 318,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(PageContainer, {\n      children: [/*#__PURE__*/_jsxDEV(PageHeader, {\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"Excel Upload\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 321,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(SizibleButton, {\n          as: \"a\",\n          href: \"/admin/dashboard\",\n          variant: \"secondary\",\n          children: \"Back to Dashboard\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 322,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 320,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(SizibleCard, {\n        elevated: true,\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"Upload Product Data\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 328,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Upload an Excel file containing product data. The system will process the file and update the database accordingly.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 329,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"The Excel file should contain the following columns: FE_Item_Code, Name, Brand, Type, Size, Color, etc.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 330,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(UploadArea, {\n          isDragging: isDragging,\n          onDragOver: handleDragOver,\n          onDragLeave: handleDragLeave,\n          onDrop: handleDrop,\n          onClick: handleUploadClick,\n          children: [/*#__PURE__*/_jsxDEV(UploadIcon, {\n            children: \"\\uD83D\\uDCC4\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 339,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"Drag & Drop Excel File Here\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 340,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"or click to browse files\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 341,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(FileInput, {\n            type: \"file\",\n            ref: fileInputRef,\n            accept: \".xlsx,.xls\",\n            onChange: handleFileInputChange\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 342,\n            columnNumber: 13\n          }, this), selectedFile && /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"Selected file:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 349,\n              columnNumber: 18\n            }, this), \" \", selectedFile.name]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 349,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 332,\n          columnNumber: 11\n        }, this), uploadStatus && /*#__PURE__*/_jsxDEV(StatusMessage, {\n          type: uploadStatus.type,\n          children: uploadStatus.message\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 354,\n          columnNumber: 13\n        }, this), isUploading && /*#__PURE__*/_jsxDEV(ProgressContainer, {\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"Uploading: \", uploadProgress, \"%\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 361,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(ProgressBar, {\n            children: /*#__PURE__*/_jsxDEV(ProgressFill, {\n              progress: uploadProgress\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 363,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 362,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 360,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(SizibleButton, {\n          onClick: handleUpload,\n          disabled: !selectedFile || isUploading,\n          style: {\n            marginTop: '20px'\n          },\n          children: isUploading ? 'Processing...' : 'Upload File'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 368,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 327,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(UploadHistoryCard, {\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"Upload History\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 378,\n          columnNumber: 11\n        }, this), uploadHistory.length > 0 ? /*#__PURE__*/_jsxDEV(HistoryTable, {\n          children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n            children: /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"Filename\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 384,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"Date & Time\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 385,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"Status\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 386,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"Records Updated\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 387,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 383,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 382,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n            children: uploadHistory.map(upload => /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                children: upload.filename\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 393,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: upload.timestamp\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 394,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: /*#__PURE__*/_jsxDEV(StatusBadge, {\n                  status: upload.status,\n                  children: upload.status.charAt(0).toUpperCase() + upload.status.slice(1)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 396,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 395,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: upload.records\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 400,\n                columnNumber: 21\n              }, this)]\n            }, upload.id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 392,\n              columnNumber: 19\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 390,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 381,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"No upload history available.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 406,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 377,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 319,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n_s(ExcelUploadPage, \"8ZjyAc/4Mak+85BTf2ql4WWQD7A=\", false, function () {\n  return [useNavigate];\n});\n_c13 = ExcelUploadPage;\nexport default ExcelUploadPage;\nvar _c, _c2, _c3, _c4, _c5, _c6, _c7, _c8, _c9, _c10, _c11, _c12, _c13;\n$RefreshReg$(_c, \"PageContainer\");\n$RefreshReg$(_c2, \"PageHeader\");\n$RefreshReg$(_c3, \"UploadArea\");\n$RefreshReg$(_c4, \"UploadIcon\");\n$RefreshReg$(_c5, \"FileInput\");\n$RefreshReg$(_c6, \"ProgressContainer\");\n$RefreshReg$(_c7, \"ProgressBar\");\n$RefreshReg$(_c8, \"ProgressFill\");\n$RefreshReg$(_c9, \"StatusMessage\");\n$RefreshReg$(_c10, \"UploadHistoryCard\");\n$RefreshReg$(_c11, \"HistoryTable\");\n$RefreshReg$(_c12, \"StatusBadge\");\n$RefreshReg$(_c13, \"ExcelUploadPage\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useNavigate","styled","SizibleNavigation","SizibleButton","SizibleCard","jsxDEV","_jsxDEV","Fragment","_Fragment","PageContainer","div","props","theme","spacing","large","_c","PageHeader","medium","_c2","UploadArea","isDragging","colors","primary","borderRadius","xlarge","_c3","UploadIcon","_c4","FileInput","input","_c5","ProgressContainer","_c6","ProgressBar","small","_c7","ProgressFill","progress","_c8","StatusMessage","type","_c9","UploadHistoryCard","_c10","HistoryTable","table","typography","fontWeight","_c11","StatusBadge","span","status","_c12","ExcelUploadPage","_s","navigate","fileInputRef","setIsDragging","selectedFile","setSelectedFile","uploadProgress","setUploadProgress","uploadStatus","setUploadStatus","isUploading","setIsUploading","uploadHistory","setUploadHistory","isAuthenticated","localStorage","getItem","fetchUploadHistory","response","fetch","ok","data","json","history","Array","isArray","formattedHistory","map","item","id","filename","timestamp","Date","created_at","toLocaleString","success_count","records","console","error","handleDragOver","e","preventDefault","handleDragLeave","handleDrop","files","dataTransfer","length","handleFileSelect","file","message","name","handleFileInputChange","target","handleUploadClick","current","click","handleUpload","formData","FormData","append","method","body","result","now","getFullYear","String","getMonth","padStart","getDate","getHours","getMinutes","prevHistory","recordsUpdated","toISOString","slice","replace","err","children","fileName","_jsxFileName","lineNumber","columnNumber","as","href","variant","elevated","onDragOver","onDragLeave","onDrop","onClick","ref","accept","onChange","disabled","style","marginTop","upload","charAt","toUpperCase","_c13","$RefreshReg$"],"sources":["c:/sophia/windsurf/sizible-dev/frontend/src/pages/admin/ExcelUploadPage.js"],"sourcesContent":["/**\n * Excel Upload Page\n * \n * This page allows admin users to upload Excel files containing product data.\n * It handles file validation, upload, and displays processing status.\n */\n\nimport React, { useState, useEffect, useRef } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport styled from 'styled-components';\nimport SizibleNavigation from '../../components/common/SizibleNavigation';\nimport SizibleButton from '../../components/common/SizibleButton';\nimport SizibleCard from '../../components/common/SizibleCard';\n\n// Styled components\nconst PageContainer = styled.div`\n  padding: ${props => props.theme.spacing.large};\n  max-width: 1200px;\n  margin: 0 auto;\n`;\n\nconst PageHeader = styled.div`\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: ${props => props.theme.spacing.large};\n  \n  @media (max-width: 768px) {\n    flex-direction: column;\n    align-items: flex-start;\n    gap: ${props => props.theme.spacing.medium};\n  }\n`;\n\nconst UploadArea = styled.div`\n  border: 2px dashed ${props => props.isDragging ? props.theme.colors.primary : '#ddd'};\n  border-radius: ${props => props.theme.borderRadius.medium};\n  padding: ${props => props.theme.spacing.xlarge};\n  text-align: center;\n  margin-bottom: ${props => props.theme.spacing.large};\n  transition: all 0.3s ease;\n  background-color: ${props => props.isDragging ? 'rgba(0, 123, 255, 0.05)' : 'transparent'};\n  cursor: pointer;\n`;\n\nconst UploadIcon = styled.div`\n  font-size: 3rem;\n  margin-bottom: ${props => props.theme.spacing.medium};\n  color: ${props => props.theme.colors.primary};\n`;\n\nconst FileInput = styled.input`\n  display: none;\n`;\n\nconst ProgressContainer = styled.div`\n  margin: ${props => props.theme.spacing.large} 0;\n`;\n\nconst ProgressBar = styled.div`\n  height: 10px;\n  background-color: #f0f0f0;\n  border-radius: 5px;\n  margin-top: ${props => props.theme.spacing.small};\n  overflow: hidden;\n`;\n\nconst ProgressFill = styled.div`\n  height: 100%;\n  width: ${props => props.progress}%;\n  background-color: ${props => props.theme.colors.primary};\n  transition: width 0.3s ease;\n`;\n\nconst StatusMessage = styled.div`\n  padding: ${props => props.theme.spacing.medium};\n  border-radius: ${props => props.theme.borderRadius.small};\n  margin: ${props => props.theme.spacing.medium} 0;\n  background-color: ${props => {\n    switch(props.type) {\n      case 'success': return 'rgba(40, 167, 69, 0.1)';\n      case 'error': return 'rgba(220, 53, 69, 0.1)';\n      case 'info': return 'rgba(0, 123, 255, 0.1)';\n      default: return 'transparent';\n    }\n  }};\n  color: ${props => {\n    switch(props.type) {\n      case 'success': return '#28a745';\n      case 'error': return '#dc3545';\n      case 'info': return '#007bff';\n      default: return 'inherit';\n    }\n  }};\n  border-left: 4px solid ${props => {\n    switch(props.type) {\n      case 'success': return '#28a745';\n      case 'error': return '#dc3545';\n      case 'info': return '#007bff';\n      default: return 'transparent';\n    }\n  }};\n`;\n\nconst UploadHistoryCard = styled(SizibleCard)`\n  margin-top: ${props => props.theme.spacing.xlarge};\n`;\n\nconst HistoryTable = styled.table`\n  width: 100%;\n  border-collapse: collapse;\n  \n  th, td {\n    padding: ${props => props.theme.spacing.small};\n    text-align: left;\n    border-bottom: 1px solid #eee;\n  }\n  \n  th {\n    font-weight: ${props => props.theme.typography.fontWeight.medium};\n  }\n`;\n\nconst StatusBadge = styled.span`\n  display: inline-block;\n  padding: 4px 8px;\n  border-radius: 12px;\n  font-size: 0.8rem;\n  background-color: ${props => {\n    switch(props.status) {\n      case 'success': return 'rgba(40, 167, 69, 0.1)';\n      case 'failed': return 'rgba(220, 53, 69, 0.1)';\n      case 'processing': return 'rgba(255, 193, 7, 0.1)';\n      default: return 'rgba(0, 123, 255, 0.1)';\n    }\n  }};\n  color: ${props => {\n    switch(props.status) {\n      case 'success': return '#28a745';\n      case 'failed': return '#dc3545';\n      case 'processing': return '#ffc107';\n      default: return '#007bff';\n    }\n  }};\n`;\n\n/**\n * Excel Upload Page Component\n * \n * @returns {JSX.Element} The Excel upload page component\n */\nconst ExcelUploadPage = () => {\n  const navigate = useNavigate();\n  const fileInputRef = useRef(null);\n  const [isDragging, setIsDragging] = useState(false);\n  const [selectedFile, setSelectedFile] = useState(null);\n  const [uploadProgress, setUploadProgress] = useState(0);\n  const [uploadStatus, setUploadStatus] = useState(null);\n  const [isUploading, setIsUploading] = useState(false);\n  const [uploadHistory, setUploadHistory] = useState([]);\n  \n  // Check if admin is authenticated\n  useEffect(() => {\n    const isAuthenticated = localStorage.getItem('adminAuthenticated') === 'true';\n    if (!isAuthenticated) {\n      navigate('/admin/login');\n    }\n    \n    // Fetch upload history from the backend\n    const fetchUploadHistory = async () => {\n      try {\n        const response = await fetch('http://localhost:5000/api/admin/upload-history');\n        if (response.ok) {\n          const data = await response.json();\n          if (data.history && Array.isArray(data.history)) {\n            // Transform the data to match our frontend format\n            const formattedHistory = data.history.map(item => ({\n              id: item.id,\n              filename: item.filename,\n              timestamp: new Date(item.created_at).toLocaleString(),\n              status: item.success_count > 0 ? 'success' : 'failed',\n              records: item.success_count || 0\n            }));\n            setUploadHistory(formattedHistory);\n          }\n        } else {\n          console.error('Failed to fetch upload history');\n          // Fallback to sample data if API fails\n          setUploadHistory([\n            { id: 1, filename: 'products_march_2025.xlsx', timestamp: '2025-03-15 14:32', status: 'success', records: 124 },\n            { id: 2, filename: 'products_feb_2025.xlsx', timestamp: '2025-02-22 09:15', status: 'success', records: 98 },\n            { id: 3, filename: 'test_upload.xlsx', timestamp: '2025-02-10 16:45', status: 'failed', records: 0 }\n          ]);\n        }\n      } catch (error) {\n        console.error('Error fetching upload history:', error);\n        // Fallback to sample data if API fails\n        setUploadHistory([\n          { id: 1, filename: 'products_march_2025.xlsx', timestamp: '2025-03-15 14:32', status: 'success', records: 124 },\n          { id: 2, filename: 'products_feb_2025.xlsx', timestamp: '2025-02-22 09:15', status: 'success', records: 98 },\n          { id: 3, filename: 'test_upload.xlsx', timestamp: '2025-02-10 16:45', status: 'failed', records: 0 }\n        ]);\n      }\n    };\n    \n    fetchUploadHistory();\n  }, [navigate]);\n  \n  // Handle drag events\n  const handleDragOver = (e) => {\n    e.preventDefault();\n    setIsDragging(true);\n  };\n  \n  const handleDragLeave = () => {\n    setIsDragging(false);\n  };\n  \n  const handleDrop = (e) => {\n    e.preventDefault();\n    setIsDragging(false);\n    \n    const files = e.dataTransfer.files;\n    if (files.length > 0) {\n      handleFileSelect(files[0]);\n    }\n  };\n  \n  // Handle file selection\n  const handleFileSelect = (file) => {\n    // Check if file is an Excel file\n    if (file && (file.type === 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' || \n                file.type === 'application/vnd.ms-excel')) {\n      setSelectedFile(file);\n      setUploadStatus({ type: 'info', message: `File \"${file.name}\" selected and ready for upload.` });\n    } else {\n      setSelectedFile(null);\n      setUploadStatus({ type: 'error', message: 'Please select a valid Excel file (.xlsx or .xls).' });\n    }\n  };\n  \n  // Handle file input change\n  const handleFileInputChange = (e) => {\n    if (e.target.files.length > 0) {\n      handleFileSelect(e.target.files[0]);\n    }\n  };\n  \n  // Handle upload button click\n  const handleUploadClick = () => {\n    fileInputRef.current.click();\n  };\n  \n  // Handle file upload\n  const handleUpload = async () => {\n    if (!selectedFile) {\n      setUploadStatus({ type: 'error', message: 'Please select a file to upload.' });\n      return;\n    }\n\n    setIsUploading(true);\n    setUploadProgress(0);\n    setUploadStatus({ type: 'info', message: 'Uploading file...' });\n\n    try {\n      const formData = new FormData();\n      formData.append('file', selectedFile);\n\n      // Optionally, add user/admin info if needed\n      // formData.append('userId', adminUserId);\n\n      const response = await fetch('http://localhost:5000/api/admin/upload-excel', {\n        method: 'POST',\n        body: formData,\n      });\n\n      const result = await response.json();\n      if (response.ok) {\n        setUploadStatus({ type: 'success', message: result.message || 'File uploaded and processed successfully.' });\n        setSelectedFile(null);\n        // Optionally, fetch updated upload history from backend here\n        // For now, append to local history\n        const now = new Date();\n        const timestamp = `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}-${String(now.getDate()).padStart(2, '0')} ${String(now.getHours()).padStart(2, '0')}:${String(now.getMinutes()).padStart(2, '0')}`;\n        setUploadHistory(prevHistory => [\n          {\n            id: prevHistory.length + 1,\n            filename: selectedFile.name,\n            timestamp,\n            status: 'success',\n            records: result.recordsUpdated || result.records || 0\n          },\n          ...prevHistory\n        ]);\n      } else {\n        setUploadStatus({ type: 'error', message: result.error || 'Failed to upload or process file.' });\n        setUploadHistory(prevHistory => [\n          {\n            id: prevHistory.length + 1,\n            filename: selectedFile.name,\n            timestamp: new Date().toISOString().slice(0, 16).replace('T', ' '),\n            status: 'failed',\n            records: 0\n          },\n          ...prevHistory\n        ]);\n      }\n    } catch (err) {\n      setUploadStatus({ type: 'error', message: 'An error occurred during upload.' });\n    } finally {\n      setIsUploading(false);\n      setUploadProgress(100);\n    }\n  };\n\n  return (\n    <>\n      <SizibleNavigation />\n      <PageContainer>\n        <PageHeader>\n          <h1>Excel Upload</h1>\n          <SizibleButton as=\"a\" href=\"/admin/dashboard\" variant=\"secondary\">\n            Back to Dashboard\n          </SizibleButton>\n        </PageHeader>\n        \n        <SizibleCard elevated>\n          <h2>Upload Product Data</h2>\n          <p>Upload an Excel file containing product data. The system will process the file and update the database accordingly.</p>\n          <p>The Excel file should contain the following columns: FE_Item_Code, Name, Brand, Type, Size, Color, etc.</p>\n          \n          <UploadArea \n            isDragging={isDragging}\n            onDragOver={handleDragOver}\n            onDragLeave={handleDragLeave}\n            onDrop={handleDrop}\n            onClick={handleUploadClick}\n          >\n            <UploadIcon>ðŸ“„</UploadIcon>\n            <h3>Drag & Drop Excel File Here</h3>\n            <p>or click to browse files</p>\n            <FileInput \n              type=\"file\" \n              ref={fileInputRef}\n              accept=\".xlsx,.xls\"\n              onChange={handleFileInputChange}\n            />\n            {selectedFile && (\n              <p><strong>Selected file:</strong> {selectedFile.name}</p>\n            )}\n          </UploadArea>\n          \n          {uploadStatus && (\n            <StatusMessage type={uploadStatus.type}>\n              {uploadStatus.message}\n            </StatusMessage>\n          )}\n          \n          {isUploading && (\n            <ProgressContainer>\n              <p>Uploading: {uploadProgress}%</p>\n              <ProgressBar>\n                <ProgressFill progress={uploadProgress} />\n              </ProgressBar>\n            </ProgressContainer>\n          )}\n          \n          <SizibleButton \n            onClick={handleUpload} \n            disabled={!selectedFile || isUploading}\n            style={{ marginTop: '20px' }}\n          >\n            {isUploading ? 'Processing...' : 'Upload File'}\n          </SizibleButton>\n        </SizibleCard>\n        \n        <UploadHistoryCard>\n          <h2>Upload History</h2>\n          \n          {uploadHistory.length > 0 ? (\n            <HistoryTable>\n              <thead>\n                <tr>\n                  <th>Filename</th>\n                  <th>Date & Time</th>\n                  <th>Status</th>\n                  <th>Records Updated</th>\n                </tr>\n              </thead>\n              <tbody>\n                {uploadHistory.map(upload => (\n                  <tr key={upload.id}>\n                    <td>{upload.filename}</td>\n                    <td>{upload.timestamp}</td>\n                    <td>\n                      <StatusBadge status={upload.status}>\n                        {upload.status.charAt(0).toUpperCase() + upload.status.slice(1)}\n                      </StatusBadge>\n                    </td>\n                    <td>{upload.records}</td>\n                  </tr>\n                ))}\n              </tbody>\n            </HistoryTable>\n          ) : (\n            <p>No upload history available.</p>\n          )}\n        </UploadHistoryCard>\n      </PageContainer>\n    </>\n  );\n};\n\nexport default ExcelUploadPage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}